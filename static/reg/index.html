<div id="wrapper">
	<div class="block">
		<form id="form-reg" class="form-horizontal">
			<legend>Register A DB</legend>
			
			<div class="control-group">
				<label class="control-label">DB Name</label>
				<div class="controls">
					<input type="text" name="username">
				</div>
			</div>
			
			<div class="control-group">
				<label class="control-label">Password</label>
				<div class="controls">
					<input type="password" name="password">
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">Password Again</label>
				<div class="controls">
					<input type="password" id="input-again">
				</div>
			</div>
			
			<div class="control-group">
				<label class="control-label">Summary</label>
				<div class="controls">
					<textarea name="summary"></textarea>
				</div>
			</div>
			
			<div class="control-group">
				<input type="submit" value="Register" class="btn btn-primary">
			</div>
		</form>
	</div>
</div>



<script>
	(function(){
		//form submit
		var $wrapper = $('#wrapper'),
			$form_reg = $wrapper.find('#form-reg');
		$form_reg.on('submit', function(ev){
			var $form = $(this);
			
			if (! validate()) {
				return false;
			}
			
			$.post('/do_reg', $form.getFormData(), function(reply){
				_.frame.notify(reply['msg']);
				
				if (reply['ok']) {
					_.frame.load('/check_db/');
				}
			});
			
			return false;
			
			function validate(){
				var pass = $form.find('[name="password"]').val(),
					pass_again = $form.find('#input-again').val();
				if (pass_again !== pass) {
					_.frame.notify('Not Match');
					return false;
				}
				return true;
			}
		});
	})();
</script>